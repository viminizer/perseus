# Phase 6.2: Layout & Behavior Refinements — Plan 01

## Objective

Refine the UI layout and navigation behavior based on user feedback from Phase 6.1.

## Execution Context

- Mode: yolo
- Depth: quick
- Estimated scope: Small (6 targeted changes)

## Context

### Current State
- Method popup renders centered on screen
- Method name left-aligned in method box
- h/l on method field cycles through methods
- Sidebar always visible (no toggle)
- Response panel on the right side of request panel
- Cursor style unchanged between modes

### Target State
- Method popup anchored over the method box
- Method name centered with padding
- h/l navigates between fields horizontally (not method cycling)
- Sidebar toggleable with Ctrl+E
- Response panel below body, ~40% screen height
- Underscore cursor in insert mode

## Tasks

### Task 1: Position method popup over method box
**File:** `src/ui/mod.rs`

Pass the method box area to `render_method_popup` and position the popup directly over/below it instead of centering on screen.

**Changes:**
- Update `render_method_popup` signature to accept method_area: Rect
- Calculate popup position relative to method_area (anchor to method box)
- Pass method_area from render_request_panel call site

**Checkpoint:** Method popup appears anchored to method box position

---

### Task 2: Center method name with padding
**File:** `src/ui/mod.rs`

Center-align the method text in the method box with horizontal padding.

**Changes:**
- Use `Alignment::Center` on the method Paragraph
- Ensure method box has adequate width for padding

**Checkpoint:** Method name displays centered in its box

---

### Task 3: Change h/l behavior on method field
**File:** `src/app.rs`

Remove method cycling on h/l. Instead, h/l should navigate to adjacent focusable elements (URL on the right, nothing on the left currently).

**Changes:**
- Remove h/l method cycling in `handle_normal_mode` when on method field
- Add horizontal navigation: l moves focus to URL field
- h on URL moves focus to Method field

**Checkpoint:** h/l navigates between Method and URL fields, no method cycling

---

### Task 4: Add sidebar toggle with Ctrl+E
**Files:** `src/app.rs`, `src/ui/mod.rs`, `src/ui/layout.rs`

Add state to track sidebar visibility. Ctrl+E toggles it. Layout adjusts when hidden.

**Changes:**
- Add `sidebar_visible: bool` field to App (default: true)
- Handle Ctrl+E in normal mode to toggle
- Update AppLayout::new to accept sidebar_visible parameter
- When hidden, give full width to content area

**Checkpoint:** Ctrl+E toggles sidebar visibility

---

### Task 5: Move response panel below body
**File:** `src/ui/layout.rs`

Restructure layout: sidebar on left, main content on right. Main content is vertical: request input row, headers, body, response (40% height).

**Changes:**
- Remove horizontal request|response split
- Create vertical layout: input_row (3), headers (5), body (remaining), response (40%)
- Update AppLayout fields and callers

**Checkpoint:** Response panel renders below body, taking ~40% of main area height

---

### Task 6: Underscore cursor in insert mode
**File:** `src/app.rs`

Change terminal cursor shape to underscore when entering insert mode, restore to default on exit.

**Changes:**
- Use `crossterm::cursor::SetCursorStyle` to set `UnderScore` on entering insert mode
- Restore `DefaultUserShape` on exiting insert mode
- Apply in handle_key transitions

**Checkpoint:** Cursor visually changes to underscore in insert mode

---

## Verification

```bash
cargo build
cargo clippy
```

Manual testing:
- Open app, press Enter on method field → popup appears over method box
- Method name is centered in its box
- h/l on method/URL navigates horizontally, does not cycle methods
- Ctrl+E hides/shows sidebar
- Response panel appears below body, ~40% height
- Press i → cursor becomes underscore; Esc → cursor normal

## Success Criteria

- [ ] Method popup anchored to method box
- [ ] Method name centered with padding
- [ ] h/l navigates horizontally between fields
- [ ] Ctrl+E toggles sidebar
- [ ] Response below body at ~40% height
- [ ] Underscore cursor in insert mode

## Output

- Commits: One per task (6 total)
- Summary: `06.2-01-SUMMARY.md`

---
*Created: 2026-02-06*
